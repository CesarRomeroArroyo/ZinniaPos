<app-header [settingHeader]="settingHeader" [customActionCompleted]="actionCompleted.bind(this)"></app-header>
<ion-content>
  <div class="container">
    <form class="form" [formGroup]="typeAppointmentsForm" *ngIf="typeAppointmentsForm">
      <ion-label for="appointmentType" class="title bold">Tipo de consulta</ion-label>
      <ion-item 
        *ngIf="!loading"
        lines="none"
        class="bordered-item"
        (click)="selectAppointmentType()">
        <ion-input
          mode="md"
          label="Tipo de consulta"
          labelPlacement="stacked"
          placeholder="Tipo de consulta"
          readonly
          [value]="getAppointmentTypeLabel()"
          formControlName="appointmentType">
        </ion-input>
        <ion-icon name="chevron-forward-outline" slot="end"></ion-icon>
      </ion-item>

      <ion-item lines="none" class="bordered-item skeleton" *ngIf="loading">
        <ion-label>
          <ion-skeleton-text style="width: 87.53px;" [animated]="true"></ion-skeleton-text>
          <ion-skeleton-text style="width: 115.53px; height: 18px;" [animated]="true"></ion-skeleton-text>
        </ion-label>
        <ion-thumbnail style="width: 25.6px; height: 25.6px;" slot="end">
          <ion-skeleton-text [animated]="true"></ion-skeleton-text>
        </ion-thumbnail>
      </ion-item>
    </form>
  </div> 

  <div class="container">
    <form class="form" [formGroup]="daysOfServiceForm" *ngIf="daysOfServiceForm">
      <ion-label for="daysOfService" class="title bold">Días de atención</ion-label>
      <ion-item lines="none" class="bordered-item" (click)="selectApplyTo()">
        <ion-input
          mode="md"
          readonly
          label="Aplicar a"
          labelPlacement="stacked"
          placeholder="Selecciona una opción"
          [value]="getApplyToLabel()"
          formControlName="applyTo">
        </ion-input>
        <ion-icon name="chevron-forward-outline" slot="end"></ion-icon>
      </ion-item>
      <div class="weekDays" *ngIf="daysOfServiceForm.get('applyTo')?.value === ValueServiceDaysOptions.WEEK_DAYS">
        <ion-grid>
          <ion-row>
            <ion-col size="6" *ngFor="let day of weekDays">
              <ion-item lines="none">
                <ion-checkbox
                  slot="start"
                  [checked]="isSelected(day.key)"
                  (ionChange)="onToggleDay(day.key, $event.detail.checked)"
                  justify="start">
                </ion-checkbox>
                <ion-label>{{ day.label }}</ion-label>
              </ion-item>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>

      <div class="days-of-month" *ngIf="daysOfServiceForm.get('applyTo')?.value === ValueServiceDaysOptions.DAYS_OF_MONTH">
        <ion-datetime
          presentation="date"
          [multiple]="true">
        </ion-datetime>
      </div>
    </form>
  </div>

  <div class="container">
    <ion-label class="title bold">Horario de atención</ion-label>
    <div class="interval-container"> 
      <div class="interval" *ngFor="let interval of intervals; let i = index">
        <span (click)="openTimePicker(i, 'from')">{{ interval.from }}</span>
          <span>a</span>
          <span (click)="openTimePicker(i, 'to')">{{ interval.to }}</span>
          <ion-icon name="trash-outline" (click)="removeInterval(i)" class="delete-icon"></ion-icon>
      </div>
      <ion-button mode="md" expand="block" fill="outline"  (click)="addInterval()">
        Agregar intervalo de tiempo
      </ion-button>
    </div>
  </div>  

</ion-content>

<ion-footer class="ion-no-border footer">
  <ion-button
    mode="md"
    expand="block"
    fill="solid"
    (click)="sendForm()">
    Guardar
  </ion-button>
</ion-footer>
